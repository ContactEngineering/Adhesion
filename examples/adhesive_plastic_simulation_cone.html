<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adhesive Plastic Simulation &mdash; Adhesion 0.91.0.dev41+ge00e3ae documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="power_law_potential.html" />
    <link rel="prev" title="Example of rough simulation with adhesion on the contact challenge 512x512 topography" href="adhesive_simulation_rough.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Adhesion
          </a>
              <div class="version">
                0.91.0.dev41+ge00e3ae
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to Adhesion</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="adhesive_simulation_sphere.html">Adhesive Simulation of the contact of a sphere</a></li>
<li class="toctree-l2"><a class="reference internal" href="adhesive_simulation_rough.html">Example of rough simulation with adhesion on the contact challenge 512x512 topography</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adhesive Plastic Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#prepare-geometry">Prepare Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#material-properties">Material Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setup-system">setup system</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-history">loading history</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simulate">Simulate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plot-pressure-distributions-and-deformed-profiles">plot pressure distributions and deformed profiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalar-quantities-during-loading">scalar quantities during loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sinewave_bem_vs_jkr.html">Smooth against JKR</a></li>
<li class="toctree-l2"><a class="reference internal" href="sinewave_bem_vs_jkr.html#hardwall-against-jkr">Hardwall against JKR</a></li>
<li class="toctree-l2"><a class="reference internal" href="contacting_points.html">computing contact areas</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/Adhesion.Interactions.html">Adhesion.Interactions package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/Adhesion.System.html">Adhesion.System package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/Adhesion.ReferenceSolutions.html">Adhesion.ReferenceSolutions package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Adhesion</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Examples</a></li>
      <li class="breadcrumb-item active">Adhesive Plastic Simulation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/adhesive_plastic_simulation_cone.py.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ---</span>
<span class="c1"># jupyter:</span>
<span class="c1">#   jupytext:</span>
<span class="c1">#     formats: py:percent</span>

<span class="c1">#     text_representation:</span>
<span class="c1">#       extension: .py</span>
<span class="c1">#       format_name: percent</span>
<span class="c1">#       format_version: &#39;1.3&#39;</span>
<span class="c1">#       jupytext_version: 1.14.4</span>
<span class="c1">#   kernelspec:</span>
<span class="c1">#     display_name: Python 3</span>
<span class="c1">#     language: python</span>
<span class="c1">#     name: python3</span>
<span class="c1"># ---</span>
</pre></div>
</div>
</div>
</div>
<section id="adhesive-plastic-simulation">
<h1>Adhesive Plastic Simulation<a class="headerlink" href="#adhesive-plastic-simulation" title="Permalink to this heading"></a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">SurfaceTopography</span> <span class="kn">import</span> <span class="n">Topography</span><span class="p">,</span> <span class="n">PlasticTopography</span>
<span class="kn">from</span> <span class="nn">ContactMechanics</span> <span class="kn">import</span> <span class="n">FreeFFTElasticHalfSpace</span>
<span class="kn">from</span> <span class="nn">Adhesion.Interactions</span> <span class="kn">import</span> <span class="n">Lj82</span>
<span class="kn">from</span> <span class="nn">Adhesion.System</span> <span class="kn">import</span> <span class="n">make_system</span>
<span class="kn">from</span> <span class="nn">Adhesion.System</span> <span class="kn">import</span> <span class="n">PlasticSmoothContactSystem</span>
<span class="kn">from</span> <span class="nn">ContactMechanics.Tools.Logger</span> <span class="kn">import</span> <span class="n">screen</span><span class="p">,</span> <span class="n">Logger</span>
</pre></div>
</div>
</div>
</div>
<section id="prepare-geometry">
<h2>Prepare Geometry<a class="headerlink" href="#prepare-geometry" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span><span class="mi">128</span>

<span class="n">sx</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">sy</span> <span class="o">=</span> <span class="mi">250</span> 

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">sx</span><span class="o">/</span><span class="n">nx</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="o">*</span> <span class="n">sy</span><span class="o">/</span><span class="n">ny</span> <span class="o">-</span> <span class="n">sy</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">topography</span><span class="o">=</span> <span class="n">Topography</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">*</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">physical_sizes</span><span class="o">=</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">topography</span><span class="o">.</span><span class="n">heights</span><span class="p">()),</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;heights&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x ($z_0$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y ($z_0$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;y ($z_0$)&#39;)
</pre></div>
</div>
<img alt="../_images/8097d4ce61d59275b9c2f5b9cca020554b80c8c4f2f13d521d487f0cbb5cb6f7.png" src="../_images/8097d4ce61d59275b9c2f5b9cca020554b80c8c4f2f13d521d487f0cbb5cb6f7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">topography</span><span class="o">.</span><span class="n">heights</span><span class="p">()[:,</span> <span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x ($z_0$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;heights ($z_0$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;heights ($z_0$)&#39;)
</pre></div>
</div>
<img alt="../_images/f2221a38d260912350026bf060d2498aa7b5e75d05c37a6e83c46d5cbd54acc3.png" src="../_images/f2221a38d260912350026bf060d2498aa7b5e75d05c37a6e83c46d5cbd54acc3.png" />
</div>
</div>
</section>
<section id="material-properties">
<h2>Material Properties<a class="headerlink" href="#material-properties" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Es</span> <span class="o">=</span> <span class="mf">50.</span>
<span class="n">hardness</span> <span class="o">=</span> <span class="mf">2.</span>
<span class="n">z0</span> <span class="o">=</span> <span class="mf">1.</span> 
<span class="n">w</span> <span class="o">=</span> <span class="mf">1.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="setup-system">
<h2>setup system<a class="headerlink" href="#setup-system" title="Permalink to this heading"></a></h2>
<p>the <code class="docutils literal notranslate"><span class="pre">make_system</span></code> automatically knows it has to do a plastic simulation if we pass a <code class="docutils literal notranslate"><span class="pre">PlasticTopogaraphy</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">system</span> <span class="o">=</span> <span class="n">make_system</span><span class="p">(</span>
    <span class="n">interaction</span><span class="o">=</span><span class="n">Lj82</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">z0</span><span class="p">),</span>
    <span class="n">substrate</span><span class="o">=</span><span class="n">FreeFFTElasticHalfSpace</span><span class="p">(</span>
        <span class="n">nb_grid_pts</span><span class="o">=</span><span class="n">topography</span><span class="o">.</span><span class="n">nb_grid_pts</span><span class="p">,</span> <span class="n">young</span><span class="o">=</span><span class="n">Es</span><span class="p">,</span>
        <span class="n">physical_sizes</span><span class="o">=</span><span class="n">topography</span><span class="o">.</span><span class="n">physical_sizes</span><span class="p">,</span>
        <span class="n">check_boundaries</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">surface</span><span class="o">=</span><span class="n">PlasticTopography</span><span class="p">(</span><span class="n">topography</span><span class="o">=</span><span class="n">topography</span><span class="p">,</span> <span class="n">hardness</span><span class="o">=</span><span class="n">hardness</span><span class="p">),</span>
    <span class="n">system_class</span><span class="o">=</span><span class="n">PlasticSmoothContactSystem</span>
           <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">z</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.85</span><span class="o">*</span><span class="n">z0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">z0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">poti</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Lj82</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">z0</span><span class="p">),</span> <span class="n">system</span><span class="o">.</span><span class="n">interaction</span><span class="p">]:</span>
    <span class="n">p</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">poti</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;potential&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;force&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;curvature&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
    <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;separation&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ca58c9dbe309f2c31d76df8eb894e3c322fc3f88df757acfc103029608696c32.png" src="../_images/ca58c9dbe309f2c31d76df8eb894e3c322fc3f88df757acfc103029608696c32.png" />
</div>
</div>
<section id="loading-history">
<h3>loading history<a class="headerlink" href="#loading-history" title="Permalink to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penetrations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">penetrations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">penetrations</span><span class="p">,</span> <span class="n">penetrations</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulate">
<h3>Simulate<a class="headerlink" href="#simulate" title="Permalink to this heading"></a></h3>
<p>Choice of the gradient tolerance: The gradient is the error in the balance
of the elastic-force and the adhesive force on each pixel.</p>
<p>This error should be small compared to this force.</p>
<p>In plastic and adhesive simulations the pressures are bopund by the hardness or
the maximum interaction stress. This value multiplied by the pixel size gives us
the order of magnitude of the pixel forces. These forces increase with pixel size,
and so do the achievable gradient tolerance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hardness</span> <span class="o">*</span> <span class="n">topography</span><span class="o">.</span><span class="n">area_per_pt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.62939453125
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gtol</span> <span class="o">=</span> <span class="mf">1e-3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare empty arrays to contain results</span>
<span class="n">offsets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">plastic_areas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">normal_forces</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">repulsive_areas</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">forces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">penetrations</span><span class="p">),</span> <span class="o">*</span><span class="n">topography</span><span class="o">.</span><span class="n">nb_grid_pts</span><span class="p">))</span> <span class="c1"># forces[timestep,...]: array of forces for each gridpoint</span>
<span class="n">elastic_displacements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">penetrations</span><span class="p">),</span> <span class="o">*</span><span class="n">topography</span><span class="o">.</span><span class="n">nb_grid_pts</span><span class="p">))</span>
<span class="n">plastified_topographies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">disp0</span><span class="o">=</span><span class="kc">None</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">penetration</span> <span class="ow">in</span> <span class="n">penetrations</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;penetration = </span><span class="si">{</span><span class="n">penetration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">minimize_proxy</span><span class="p">(</span>                                       
        <span class="n">initial_displacements</span><span class="o">=</span><span class="n">disp0</span><span class="p">,</span>                                                                                       
        <span class="n">options</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">gtol</span><span class="o">=</span><span class="n">gtol</span><span class="p">,</span> <span class="c1"># max absolute value of the gradient of the objective for convergence </span>
                     <span class="n">ftol</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1"># stop only if the gradient criterion is fullfilled</span>
                     <span class="n">maxcor</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># number of gradients stored for hessian approximation</span>
                    <span class="p">),</span>                               
        <span class="n">logger</span><span class="o">=</span><span class="n">Logger</span><span class="p">(</span><span class="s2">&quot;laststep.log&quot;</span><span class="p">),</span>                                 
        <span class="n">offset</span><span class="o">=</span><span class="n">penetration</span><span class="p">,</span>                                           
        <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                                                 
                <span class="p">)</span>
    <span class="k">assert</span> <span class="n">sol</span><span class="o">.</span><span class="n">success</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">message</span>
    <span class="n">disp0</span> <span class="o">=</span> <span class="n">u</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">disp</span> <span class="c1"># TODO: the disp0 should only include the elastic displacements. u contains ela</span>
    <span class="n">normal_forces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">compute_normal_force</span><span class="p">())</span>
    <span class="n">plastic_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">plastic_area</span><span class="p">)</span>
    <span class="n">repulsive_areas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">compute_repulsive_contact_area</span><span class="p">())</span>
    
    <span class="n">plastified_topographies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
    <span class="c1">#system.surface=PlasticTopography(topography=topography, hardness=hardness) # reset surface</span>
    <span class="n">forces</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">system</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">evaluate_force</span><span class="p">(</span><span class="n">u</span><span class="p">)[</span><span class="n">system</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">topography_subdomain_slices</span><span class="p">]</span>
    <span class="c1"># this may be wronmg as well because it includes the plastic displacements ? </span>
    <span class="n">elastic_displacements</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">disp</span><span class="p">[</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">subdomain_slices</span><span class="p">]</span> 
    <span class="c1"># doesn&#39;t this include the plastic displacements as well now ? </span>
    <span class="c1"># no the plastic displacement is in the extra compliance of the linear part of the potential.</span>
    
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="c1">#print(np.max(system.surface.plastic_displ))</span>
    <span class="c1">#print(np.min(system.surface.plastic_displ))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = -1.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = -0.25
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = 0.5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = 1.25
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = 2.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = 1.25
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = 0.5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = -0.25
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>penetration = -1.0
</pre></div>
</div>
</div>
</div>
<p>Bug small steps in the not yet in contact region leads to problems, why ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">penetration</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>open<span class="w"> </span>laststep.log
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/bin/sh: 1: open: not found
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="plot-pressure-distributions-and-deformed-profiles">
<h2>plot pressure distributions and deformed profiles<a class="headerlink" href="#plot-pressure-distributions-and-deformed-profiles" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">penetrations</span><span class="p">)):</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">axf</span><span class="p">,</span> <span class="n">axfcut</span><span class="p">,</span> <span class="n">axtopcut</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    
    <span class="n">axf</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (mm)&quot;</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (mm)&quot;</span><span class="p">)</span>
        
    <span class="n">axfcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">positions</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">forces</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span> <span class="n">system</span><span class="o">.</span><span class="n">area_per_pt</span><span class="p">)</span>
    <span class="n">axfcut</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">axfcut</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;pressures MPa&quot;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="n">axfcut</span><span class="p">,</span> <span class="n">axtopcut</span><span class="p">):</span>
        <span class="n">a</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (mm)&quot;</span><span class="p">)</span>
    <span class="n">axtopcut</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;height (mm)&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">axf</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="o">*</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">positions</span><span class="p">(),</span> <span class="n">forces</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">...</span><span class="p">]</span><span class="o">/</span> <span class="n">system</span><span class="o">.</span><span class="n">area_per_pt</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;pressures MPa&quot;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axf</span><span class="p">)</span>
    <span class="n">axf</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">axtopcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">positions</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">topography</span><span class="o">.</span><span class="n">heights</span><span class="p">()[:,</span> <span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> 
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;original&quot;</span><span class="p">)</span>
    <span class="n">axtopcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">positions</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">plastified_topographies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">heights</span><span class="p">()[:,</span> <span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> 
                  <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;plast.&quot;</span><span class="p">)</span>
    <span class="n">axtopcut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">surface</span><span class="o">.</span><span class="n">positions</span><span class="p">()[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">plastified_topographies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">heights</span><span class="p">()[:,</span> <span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">elastic_displacements</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span> <span class="n">ny</span><span class="o">//</span><span class="mi">2</span><span class="p">],</span> 
                  <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;plast. el.&quot;</span><span class="p">)</span>
    <span class="n">axtopcut</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/de145860a78ea55a3170eff0f48a8a36ea5c50aa72e01ad91f3101e97b3997ca.png" src="../_images/de145860a78ea55a3170eff0f48a8a36ea5c50aa72e01ad91f3101e97b3997ca.png" />
<img alt="../_images/4c64c1af57ff86fee803bc591f143504c88472808572c361f74745fe8544f929.png" src="../_images/4c64c1af57ff86fee803bc591f143504c88472808572c361f74745fe8544f929.png" />
<img alt="../_images/c8f8eef94092617ba6043ac48a7a810e27bac6299eaed9cd5bdefc75a69b6f12.png" src="../_images/c8f8eef94092617ba6043ac48a7a810e27bac6299eaed9cd5bdefc75a69b6f12.png" />
<img alt="../_images/6bb2789c0100a9f6a3f74f213925c9bbfda45a41bcada87a19ff5c236f8de456.png" src="../_images/6bb2789c0100a9f6a3f74f213925c9bbfda45a41bcada87a19ff5c236f8de456.png" />
<img alt="../_images/b51bfd02786101dc233d0083f18c9bb92cbe5ec4d31397dc2dea7c615a607a8a.png" src="../_images/b51bfd02786101dc233d0083f18c9bb92cbe5ec4d31397dc2dea7c615a607a8a.png" />
<img alt="../_images/8ca0f90eee43bc9547fc94007c75a7de99046259b082da7906f25b8ea5ba39c0.png" src="../_images/8ca0f90eee43bc9547fc94007c75a7de99046259b082da7906f25b8ea5ba39c0.png" />
<img alt="../_images/d67d16270778603da401e0f91545bc62da3997a16e92ba8026d858a19ac2027d.png" src="../_images/d67d16270778603da401e0f91545bc62da3997a16e92ba8026d858a19ac2027d.png" />
<img alt="../_images/2458731d1b4b806942d61163508bfb220d65bc421fb86fa0e6a5830a5d0e0ad1.png" src="../_images/2458731d1b4b806942d61163508bfb220d65bc421fb86fa0e6a5830a5d0e0ad1.png" />
<img alt="../_images/f45d7f5299502633ed14b09485ef88d87ffe0f032c8e770b9d46cf81d6b25d77.png" src="../_images/f45d7f5299502633ed14b09485ef88d87ffe0f032c8e770b9d46cf81d6b25d77.png" />
</div>
</div>
</section>
<section id="scalar-quantities-during-loading">
<h2>scalar quantities during loading<a class="headerlink" href="#scalar-quantities-during-loading" title="Permalink to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">penetrations</span><span class="p">,</span> <span class="n">normal_forces</span><span class="p">,</span><span class="s2">&quot;+-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;rigid body penetration [mm]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Force [N]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Force [N]&#39;)
</pre></div>
</div>
<img alt="../_images/ea66fa658fa1d95b50a0466d4a66e93c70113c2d21c29f8f0299c5b5ad2c44d4.png" src="../_images/ea66fa658fa1d95b50a0466d4a66e93c70113c2d21c29f8f0299c5b5ad2c44d4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normal_forces</span><span class="p">,</span> <span class="n">plastic_areas</span><span class="p">,</span> <span class="s2">&quot;-+&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Force (N)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;plastic area (mm^2)&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8aa49edc4482749d58c0dc1e374b3ab671475c8183172d8525541efce258ae61.png" src="../_images/8aa49edc4482749d58c0dc1e374b3ab671475c8183172d8525541efce258ae61.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normal_forces</span><span class="p">,</span> <span class="n">repulsive_areas</span><span class="p">,</span> <span class="s2">&quot;+-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;indentation force (N)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;contact area (mm^2)&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/156296d55810980264aa4a144b5a0f319c165a3ab28ef65da2642982f8e7db1c.png" src="../_images/156296d55810980264aa4a144b5a0f319c165a3ab28ef65da2642982f8e7db1c.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="adhesive_simulation_rough.html" class="btn btn-neutral float-left" title="Example of rough simulation with adhesion on the contact challenge 512x512 topography" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="power_law_potential.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2020 The Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>