

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Adhesion.System package &mdash; Adhesion 0.90.0.dev54+gf25962a documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adhesion.ReferenceSolutions package" href="Adhesion.ReferenceSolutions.html" />
    <link rel="prev" title="Adhesion.Interactions package" href="Adhesion.Interactions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Adhesion
          

          
          </a>

          
            
            
              <div class="version">
                0.90.0.dev54+gf25962a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to Adhesion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Adhesion.Interactions.html">Adhesion.Interactions package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Adhesion.System package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-Adhesion.System.Factory">Adhesion.System.Factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Adhesion.System.Factory.make_system"><code class="docutils literal notranslate"><span class="pre">make_system()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Adhesion.System.PlasticSystemSpecialisations">Adhesion.System.PlasticSystemSpecialisations module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem"><code class="docutils literal notranslate"><span class="pre">PlasticSmoothContactSystem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem.handles"><code class="docutils literal notranslate"><span class="pre">PlasticSmoothContactSystem.handles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem.minimize_proxy"><code class="docutils literal notranslate"><span class="pre">PlasticSmoothContactSystem.minimize_proxy()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Adhesion.System.SmoothSystemSpecialisations">Adhesion.System.SmoothSystemSpecialisations module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.BndSet"><code class="docutils literal notranslate"><span class="pre">BndSet</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.BndSet.large"><code class="docutils literal notranslate"><span class="pre">BndSet.large</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.BndSet.small"><code class="docutils literal notranslate"><span class="pre">BndSet.small</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.BabushkaBoundaryError"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.BabushkaBoundaryError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.FreeBoundaryError"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.FreeBoundaryError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.callback"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.check_margins"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.check_margins()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.check_margins_babushka"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.check_margins_babushka()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.compute_babushka_bounds"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.compute_babushka_bounds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.compute_normal_force"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.compute_normal_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.create_babushka"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.create_babushka()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.deproxified"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.deproxified()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.evaluate"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.handles"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.handles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.minimize_proxy"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.minimize_proxy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.objective"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.objective()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.shape_minimisation_input"><code class="docutils literal notranslate"><span class="pre">FastSmoothContactSystem.shape_minimisation_input()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Adhesion.System.Systems">Adhesion.System.Systems module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_attractive_coordinates"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_attractive_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_attractive_force"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_attractive_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_attractive_pts"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_nb_attractive_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_contact_pts"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_nb_contact_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_repulsive_pts"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_nb_repulsive_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_normal_force"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_normal_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_repulsive_coordinates"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_repulsive_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_repulsive_force"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.compute_repulsive_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.handles"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.handles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.logger_input"><code class="docutils literal notranslate"><span class="pre">BoundedSmoothContactSystem.logger_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.callback"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_attractive_contact_area"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_attractive_contact_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_attractive_coordinates"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_attractive_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_attractive_force"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_attractive_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_mean_gap"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_mean_gap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_nb_attractive_pts"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_nb_attractive_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_nb_contact_pts"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_nb_contact_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_nb_repulsive_pts"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_nb_repulsive_pts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_normal_force"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_normal_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_contact_area"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_repulsive_contact_area()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_coordinates"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_repulsive_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_force"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.compute_repulsive_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.evaluate"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.evaluate_k"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.evaluate_k()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.handles"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.handles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.hessian_product_function"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.hessian_product_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.logger_input"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.logger_input()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.nb_grid_pts"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.nb_grid_pts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.objective"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.objective()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.objective_k_float"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.objective_k_float()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.preconditioned_objective"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.preconditioned_objective()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.primal_evaluate"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.primal_evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.primal_hessian_product"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.primal_hessian_product()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem.primal_objective"><code class="docutils literal notranslate"><span class="pre">SmoothContactSystem.primal_objective()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-Adhesion.System">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Adhesion.ReferenceSolutions.html">Adhesion.ReferenceSolutions package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Adhesion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Adhesion.System package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/source/Adhesion.System.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="adhesion-system-package">
<h1>Adhesion.System package<a class="headerlink" href="#adhesion-system-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-Adhesion.System.Factory">
<span id="adhesion-system-factory-module"></span><h2>Adhesion.System.Factory module<a class="headerlink" href="#module-Adhesion.System.Factory" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="Adhesion.System.Factory.make_system">
<span class="sig-prename descclassname"><span class="pre">Adhesion.System.Factory.</span></span><span class="sig-name descname"><span class="pre">make_system</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">communicator=&lt;NuMPI.MPIStub.Intracomm</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">physical_sizes=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_class=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Factory.html#make_system"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Factory.make_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory function for contact systems. The returned object is always
of a subtype of SystemBase.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>substrate<span class="classifier">ContactMechanics.Substrate</span></dt><dd><p>Defines the solid mechanics in the substrate</p>
</dd>
<dt>interaction<span class="classifier">Adhesion.Interaction</span></dt><dd><p>Defines the contact formulation</p>
</dd>
<dt>surface<span class="classifier">SurfaceTopography.Topography</span></dt><dd><p>Defines the profile.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>system</strong></p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>child class of SystemBase</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-Adhesion.System.PlasticSystemSpecialisations">
<span id="adhesion-system-plasticsystemspecialisations-module"></span><h2>Adhesion.System.PlasticSystemSpecialisations module<a class="headerlink" href="#module-Adhesion.System.PlasticSystemSpecialisations" title="Permalink to this heading">¶</a></h2>
<p>implements plastic mapping algorithms for contact systems</p>
<dl class="py class">
<dt class="sig sig-object py" id="Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Adhesion.System.PlasticSystemSpecialisations.</span></span><span class="sig-name descname"><span class="pre">PlasticSmoothContactSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/PlasticSystemSpecialisations.html#PlasticSmoothContactSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem" title="Adhesion.System.Systems.SmoothContactSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothContactSystem</span></code></a></p>
<p>This system implements a simple penetration hardness model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem.handles">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_domain_decomposed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/PlasticSystemSpecialisations.html#PlasticSmoothContactSystem.handles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem.handles" title="Permalink to this definition">¶</a></dt>
<dd><p>determines whether this class can handle the proposed system
composition
Keyword Arguments:
substrate_type   – instance of ElasticSubstrate subclass
interaction_type – instance of Interaction
surface_type     –</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem.minimize_proxy">
<span class="sig-name descname"><span class="pre">minimize_proxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/PlasticSystemSpecialisations.html#PlasticSmoothContactSystem.minimize_proxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.PlasticSystemSpecialisations.PlasticSmoothContactSystem.minimize_proxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-Adhesion.System.SmoothSystemSpecialisations">
<span id="adhesion-system-smoothsystemspecialisations-module"></span><h2>Adhesion.System.SmoothSystemSpecialisations module<a class="headerlink" href="#module-Adhesion.System.SmoothSystemSpecialisations" title="Permalink to this heading">¶</a></h2>
<p>implements the periodic and non-periodic smooth contact systems</p>
<dl class="py class">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.BndSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Adhesion.System.SmoothSystemSpecialisations.</span></span><span class="sig-name descname"><span class="pre">BndSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">large</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.BndSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.BndSet.large">
<span class="sig-name descname"><span class="pre">large</span></span><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.BndSet.large" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.BndSet.small">
<span class="sig-name descname"><span class="pre">small</span></span><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.BndSet.small" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Adhesion.System.SmoothSystemSpecialisations.</span></span><span class="sig-name descname"><span class="pre">FastSmoothContactSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">margin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem" title="Adhesion.System.Systems.SmoothContactSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothContactSystem</span></code></a></p>
<p>This proxy class tries to take advantage of the system-physical_sizes
independence of non-periodic FFT-solved systems by determining the required
minimum system physical_sizes, encapsulating a SmoothContactSystem of
that physical_sizes and run it almost transparently instead of the full
system.
It’s almost transparent, because by its nature, the small system does not
compute displacements everywhere the large system exists. Therefore, for
full-domain output, an extra evaluation step must be taken. But since using
the small system significantly increases optimisation speed, this tradeoff
seems to be well worth the trouble.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.BabushkaBoundaryError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BabushkaBoundaryError</span></span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.BabushkaBoundaryError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.BabushkaBoundaryError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Called when the choosen physical_sizes of the Babushka System
had an Influence on the Solution. In the Future, one may catch
this error, increase the margin and restart minimization</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.FreeBoundaryError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FreeBoundaryError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.FreeBoundaryError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.FreeBoundaryError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>called when the supplied system cannot be computed with the current
constraints</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple callback function that can be handed over to scipy’s minimize to
get updates during minimisation
Parameters:
———-
force: bool, optional</p>
<blockquote>
<div><p>whether to include the norm of the force
vector in the update message
(default False)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.check_margins">
<span class="sig-name descname"><span class="pre">check_margins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.check_margins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.check_margins" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether the safety margin is sufficient (i.e. the outer ring of
the force array equals zero</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.check_margins_babushka">
<span class="sig-name descname"><span class="pre">check_margins_babushka</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.check_margins_babushka"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.check_margins_babushka" title="Permalink to this definition">¶</a></dt>
<dd><p>Inspired from check_margins but acts on the babushka System:
When the pressures are non-zero at the boundary of the babushka-area,
boundaries have an effect on the Solution
this raises an error because the area has been chosen too small and the</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.compute_babushka_bounds">
<span class="sig-name descname"><span class="pre">compute_babushka_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">babushka_nb_grid_pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.compute_babushka_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.compute_babushka_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a list of tuples that contain the equivalent slices in the
small and the large array. It differentiates between nb_grid_pts and
nb_domain_grid_pts.
Parameters:
babushka_nb_grid_pts – nb_grid_pts of smaller scale</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.compute_normal_force">
<span class="sig-name descname"><span class="pre">compute_normal_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.compute_normal_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.compute_normal_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.create_babushka">
<span class="sig-name descname"><span class="pre">create_babushka</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.create_babushka"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.create_babushka" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a (much smaller) system with just the contacting patch plus the
margin</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.deproxified">
<span class="sig-name descname"><span class="pre">deproxified</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.deproxified"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.deproxified" title="Permalink to this definition">¶</a></dt>
<dd><p>Extrapolates the state of the babushka system onto the proxied sytem</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the energies and forces in the system for a given displacement
field</p>
<section id="id1">
<h3>Parameters:<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>disp: ndarray</dt><dd><p>displacement field, in the shape of
system.substrate.nb_subdomain_grid_pts</p>
</dd>
<dt>offset: float</dt><dd><p>determines indentation depth,
constant value added to the heights (system.topography)</p>
</dd>
<dt>pot: bool, optional</dt><dd><p>Wether to evaluate the energy, default True</p>
</dd>
<dt>forces: bool, optional</dt><dd><p>Wether to evaluate the forces, default False</p>
</dd>
<dt>logger: ContactMechanics.Tools.Logger</dt><dd><p>informations of current state of the system will be passed to
logger at every evaluation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.handles">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_domain_decomposed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.handles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.handles" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether this class (in practice a subclass) handles this
combination of types
Keyword Arguments:
substrate_type   – self-explanatory
surface_type     – self-explanatory
is_domain_decomposed: some systems cannot handle parallel computation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.minimize_proxy">
<span class="sig-name descname"><span class="pre">minimize_proxy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L-BFGS-B'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ubounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deproxify_everytime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.minimize_proxy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.minimize_proxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function. Eliminates boilerplate code for most minimisation
problems by encapsulating the use of scipy.minimize for common default
options. In the case of smart proxy systems, this may also encapsulate
things like dynamics computation of safety margins, extrapolation of
results onto the proxied system, etc.</p>
<p>Parameters:
offset     – determines indentation depth
disp0      – (default zero) initial guess for displacement field. If</p>
<blockquote>
<div><p>not chosen appropriately, results may be unreliable.</p>
</div></blockquote>
<dl class="simple">
<dt>method     – (defaults to L-BFGS-B, see scipy documentation). Be sure</dt><dd><p>to choose method that can handle high-dimensional
parameter spaces.</p>
</dd>
<dt>options    – (default None) options to be passed to the minimizer</dt><dd><p>method</p>
</dd>
</dl>
<p>gradient   – (default True) whether to use the gradient or not
tol        – (default None) tolerance for termination. For detailed</p>
<blockquote>
<div><p>control, use solver-specific options.</p>
</div></blockquote>
<dl class="simple">
<dt>callback   – (default None) callback function to be at each iteration</dt><dd><p>as callback(disp_k) where disp_k is the current
displacement vector. Instead of a callable, it can be set
to ‘True’, in which case the system’s default callback
function is called.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.objective">
<span class="sig-name descname"><span class="pre">objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.objective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.objective" title="Permalink to this definition">¶</a></dt>
<dd><p>See super().objective for general description this method’s purpose.
Difference for this class wrt ‘dumb’ systems:
Needs an initial guess for the displacement field in order to estimate
the contact area. returns both the objective and the adapted ininial
guess as a tuple
Parameters:
———–
offset: float</p>
<blockquote>
<div><p>determines indentation depth</p>
</div></blockquote>
<dl class="simple">
<dt>gradient: bool, optional</dt><dd><p>whether the gradient is supposed to be used (default False)</p>
</dd>
<dt>disp0: ndarray of float, optional</dt><dd><p>initial guess for displacement field. If
not chosen appropriately, results may be unreliable. (default zero)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.shape_minimisation_input">
<span class="sig-name descname"><span class="pre">shape_minimisation_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/SmoothSystemSpecialisations.html#FastSmoothContactSystem.shape_minimisation_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.SmoothSystemSpecialisations.FastSmoothContactSystem.shape_minimisation_input" title="Permalink to this definition">¶</a></dt>
<dd><p>For minimisation of smart systems, the initial guess array (e.g.
displacement) may have a non-intuitive shape and physical_sizes
(The problem physical_sizes
may be decreased, as for free, non-periodic systems, or increased as
with augmented-lagrangian-type issues). Use the output of this function
as argument x0 for scipy minimisation functions. Also, if your initial
guess has a shape that makes no sense, this will tell you before you
get caught in debugging scipy-code</p>
<p>Arguments:
in_array – array with the initial guess. has the intuitive shape you</p>
<blockquote>
<div><p>think it has</p>
</div></blockquote>
</dd></dl>

</dd></dl>

</section>
<section id="module-Adhesion.System.Systems">
<span id="adhesion-system-systems-module"></span><h2>Adhesion.System.Systems module<a class="headerlink" href="#module-Adhesion.System.Systems" title="Permalink to this heading">¶</a></h2>
<p>Defines the interface for Adhesion systems</p>
<dl class="py class">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Adhesion.System.Systems.</span></span><span class="sig-name descname"><span class="pre">BoundedSmoothContactSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Adhesion.System.Systems.SmoothContactSystem" title="Adhesion.System.Systems.SmoothContactSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothContactSystem</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_attractive_coordinates">
<span class="sig-name descname"><span class="pre">compute_attractive_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_attractive_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_attractive_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an array of all coordinates, where contact pressure is
attractive. Useful for evaluating the number of contact islands etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_attractive_force">
<span class="sig-name descname"><span class="pre">compute_attractive_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_attractive_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_attractive_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all attractive forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_attractive_pts">
<span class="sig-name descname"><span class="pre">compute_nb_attractive_pts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_nb_attractive_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_attractive_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute and return the number of contact points under attractive
pressure.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_contact_pts">
<span class="sig-name descname"><span class="pre">compute_nb_contact_pts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_nb_contact_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_contact_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute and return the number of contact points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_repulsive_pts">
<span class="sig-name descname"><span class="pre">compute_nb_repulsive_pts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_nb_repulsive_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_nb_repulsive_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute and return the number of contact points under repulsive
pressure.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_normal_force">
<span class="sig-name descname"><span class="pre">compute_normal_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_normal_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_normal_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_repulsive_coordinates">
<span class="sig-name descname"><span class="pre">compute_repulsive_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_repulsive_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_repulsive_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an array of all coordinates, where contact pressure is
repulsive. Useful for evaluating the number of contact islands etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.compute_repulsive_force">
<span class="sig-name descname"><span class="pre">compute_repulsive_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.compute_repulsive_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.compute_repulsive_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all repulsive forces</p>
<p>Assumptions: there</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.handles">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.handles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.handles" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether this class (in practice a subclass) handles this
combination of types
Keyword Arguments:
substrate_type   – self-explanatory
surface_type     – self-explanatory
is_domain_decomposed: some systems cannot handle parallel computation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.BoundedSmoothContactSystem.logger_input">
<span class="sig-name descname"><span class="pre">logger_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#BoundedSmoothContactSystem.logger_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.BoundedSmoothContactSystem.logger_input" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>headers</strong> (<em>list of strings</em>)</p></li>
<li><p><strong>values</strong> (<em>list</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Adhesion.System.Systems.</span></span><span class="sig-name descname"><span class="pre">SmoothContactSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SystemBase</span></code></p>
<p>For smooth contact mechanics (i.e. the ones for which optimization is only
kinda-hell</p>
<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple callback function that can be handed over to scipy’s minimize to
get updates during minimisation
Parameters:
———-
force: bool, optional</p>
<blockquote>
<div><p>whether to include the norm of the force
vector in the update message
(default False)</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_attractive_contact_area">
<span class="sig-name descname"><span class="pre">compute_attractive_contact_area</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_attractive_contact_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_attractive_contact_area" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the are where contact pressure is attractive</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_attractive_coordinates">
<span class="sig-name descname"><span class="pre">compute_attractive_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_attractive_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_attractive_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an array of all coordinates, where contact pressure is
attractive. Useful for evaluating the number of contact islands etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_attractive_force">
<span class="sig-name descname"><span class="pre">compute_attractive_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_attractive_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_attractive_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all attractive forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_mean_gap">
<span class="sig-name descname"><span class="pre">compute_mean_gap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_mean_gap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_mean_gap" title="Permalink to this definition">¶</a></dt>
<dd><p>mean of the gap in the the physical domain (means excluding padding
region for the FreeFFTElasticHalfspace)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_nb_attractive_pts">
<span class="sig-name descname"><span class="pre">compute_nb_attractive_pts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_nb_attractive_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_nb_attractive_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute and return the number of contact points under attractive
pressure. Note that this is of no physical interest, as it is a
purely numerical artefact</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_nb_contact_pts">
<span class="sig-name descname"><span class="pre">compute_nb_contact_pts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_nb_contact_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_nb_contact_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute and return the number of contact points. Note that this is of
no physical interest, as it is a purely numerical artefact</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_nb_repulsive_pts">
<span class="sig-name descname"><span class="pre">compute_nb_repulsive_pts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_nb_repulsive_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_nb_repulsive_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>compute and return the number of contact points under repulsive
pressure. Note that this is of no physical interest, as it is a
purely numerical artefact</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_normal_force">
<span class="sig-name descname"><span class="pre">compute_normal_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_normal_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_normal_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_contact_area">
<span class="sig-name descname"><span class="pre">compute_repulsive_contact_area</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_repulsive_contact_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_contact_area" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the area where contact pressure is repulsive</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_coordinates">
<span class="sig-name descname"><span class="pre">compute_repulsive_coordinates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_repulsive_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>returns an array of all coordinates, where contact pressure is
repulsive. Useful for evaluating the number of contact islands etc.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_force">
<span class="sig-name descname"><span class="pre">compute_repulsive_force</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.compute_repulsive_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.compute_repulsive_force" title="Permalink to this definition">¶</a></dt>
<dd><p>computes and returns the sum of all repulsive forces</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the energies and forces in the system for a given displacement
field</p>
<section id="id2">
<h3>Parameters:<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>disp: ndarray</dt><dd><p>displacement field, in the shape of
system.substrate.nb_subdomain_grid_pts</p>
</dd>
<dt>offset: float</dt><dd><p>determines indentation depth,
constant value added to the heights (system.topography)</p>
</dd>
<dt>pot: bool, optional</dt><dd><p>Wether to evaluate the energy, default True</p>
</dd>
<dt>forces: bool, optional</dt><dd><p>Wether to evaluate the forces, default False</p>
</dd>
<dt>logger: ContactMechanics.Tools.Logger</dt><dd><p>informations of current state of the system will be passed to
logger at every evaluation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.evaluate_k">
<span class="sig-name descname"><span class="pre">evaluate_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disp_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.evaluate_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.evaluate_k" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the energies and forces in the system for a given displacement
field in fourier space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>disp_k</strong> (<em>ndarray</em>) – displacement field in fourier space.</p></li>
<li><p><strong>gap</strong> (<em>ndarray</em>) – displacement field in real space, in the shape of
system.substrate.nb_subdomain_grid_pts</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – determines indentation depth,
constant value added to the heights (system.topography)</p></li>
<li><p><strong>mw</strong> (<em>bool</em><em>, </em><em>optional</em>) – when mass weighting is required then set this to TRUE.</p></li>
<li><p><strong>pot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to evaluate the energy, default True</p></li>
<li><p><strong>forces</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to evaluate the forces, default False</p></li>
<li><p><strong>logger</strong> (<em>ContactMechanics.Tools.Logger</em>) – informations of current state of the system will be passed to
logger at every evaluation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.handles">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.handles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.handles" title="Permalink to this definition">¶</a></dt>
<dd><p>returns whether this class (in practice a subclass) handles this
combination of types
Keyword Arguments:
substrate_type   – self-explanatory
surface_type     – self-explanatory
is_domain_decomposed: some systems cannot handle parallel computation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.hessian_product_function">
<span class="sig-name descname"><span class="pre">hessian_product_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.hessian_product_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.hessian_product_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.logger_input">
<span class="sig-name descname"><span class="pre">logger_input</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.logger_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.logger_input" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>headers</strong> (<em>list of strings</em>)</p></li>
<li><p><strong>values</strong> (<em>list</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.nb_grid_pts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nb_grid_pts</span></span><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.nb_grid_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>For systems, nb_grid_pts can become non-trivial</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.objective">
<span class="sig-name descname"><span class="pre">objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.objective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.objective" title="Permalink to this definition">¶</a></dt>
<dd><p>This helper method exposes a scipy.optimize-friendly interface to the
evaluate() method. Use this for optimization purposes, it makes sure
that the shape of disp is maintained and lets you set the offset and
‘forces’ flag without using scipy’s cumbersome argument passing
interface. Returns a function of only disp</p>
<section id="id3">
<h3>Parameters:<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>disp0: ndarray</dt><dd><p>unused variable, present only for interface compatibility
with inheriting classes</p>
</dd>
<dt>offset: float</dt><dd><p>determines indentation depth,
constant value added to the heights (system.topography)</p>
</dd>
<dt>gradient: bool, optional</dt><dd><p>Wether to evaluate the gradient, default False</p>
</dd>
<dt>logger: ContactMechanics.Tools.Logger</dt><dd><p>informations of current state of the system will be passed to
logger at every evaluation</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt>function(disp)</dt><dd><p>Parameters:
disp: an ndarray of shape</p>
<blockquote>
<div><p><cite>system.substrate.nb_subdomain_grid_pts</cite>
displacements</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>energy or energy, gradient</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.objective_k_float">
<span class="sig-name descname"><span class="pre">objective_k_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.objective_k_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.objective_k_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns callable objective as needed by scipy minimizers.</p>
<p>The optimisation varialbe is the halfcomplex fourier transform of the gap.</p>
<p>This helper method interface to the evaluate_k() method without
preconditioning active.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{1}{2(n_x n_y)} \tilde{u}\tilde{K} \bar{\tilde{u}} +
\phi(F^{-1}(\tilde{u} - \tilde{h}))  \\\end{split}\]</div>
<p>preconditioned problem:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split} \tilde{v} = \tilde{k}^{\frac{1}{2}} \tilde{u} \\\end{split}\\ \frac{1}{2(n_x n_y)} \tilde{v} \bar{\tilde{v}} +
\phi(F^{-1}(\frac{\tilde{v}}{\tilde{k}^{\frac{1}{2}}} - \tilde{h}))\end{aligned}\end{align} \]</div>
<p>\
we solve for variable <span class="math notranslate nohighlight">\(\tilde{v}\)</span>.</p>
<section id="id4">
<h3>Parameters:<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>offset: float</dt><dd><p>determines indentation depth,
constant value added to the heights (system.topography)</p>
</dd>
<dt>gradient: bool, optional</dt><dd><p>Whether to evaluate the gradient, default False</p>
</dd>
<dt>logger: ContactMechanics.Tools.Logger</dt><dd><p>information of current state of the system will be passed to
logger at every evaluation</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param disp_k<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type disp_k<span class="colon">:</span></dt>
<dd class="field-even"><p>an ndarray in fourier space</p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>energy, gradient_k_float</p>
</dd>
</dl>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>function(disp_k)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.preconditioned_objective">
<span class="sig-name descname"><span class="pre">preconditioned_objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.preconditioned_objective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.preconditioned_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>This helper method interface to the evaluate_k() method with
preconditioning active. That is, it tries to solve a simpler problem
formulated using,</p>
<p>original problem:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{2(n_x n_y)} \tilde{u}\tilde{K} \bar{\tilde{u}} +
\phi(F^{-1}(\tilde{u} - \tilde{h}))\]</div>
<p>preconditioned problem:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\begin{split}\tilde{v} = \tilde{k}^{\frac{1}{2}} \tilde{u} \\\end{split}\\ \frac{1}{2(n_x n_y)} \tilde{v}\bar{\tilde{v}} +
\phi(F^{-1}(\frac{\tilde{v}}{\tilde{k}^{\frac{1}{2}}} - \tilde{h}))\end{aligned}\end{align} \]</div>
<p>we solve for variable <span class="math notranslate nohighlight">\(\tilde{v}\)</span>.</p>
<section id="id5">
<h3>Parameters:<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>offset: float</dt><dd><p>determines indentation depth,
constant value added to the heights (system.topography)</p>
</dd>
<dt>gradient: bool, optional</dt><dd><p>Whether to evaluate the gradient, default False</p>
</dd>
<dt>logger: ContactMechanics.Tools.Logger</dt><dd><p>information of current state of the system will be passed to
logger at every evaluation</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param disp_k<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type disp_k<span class="colon">:</span></dt>
<dd class="field-even"><p>an ndarray in fourier halfcomplex space</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> (<em>scalar</em>) – energy of the system</p></li>
<li><p><strong>force_h</strong> (<em>an halfcomplex array of shape(disp_k)</em>) – force of the system</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>function(disp_k)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.primal_evaluate">
<span class="sig-name descname"><span class="pre">primal_evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.primal_evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.primal_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the energies and forces in the system for a given
displacement and gap..</p>
<section id="id6">
<h3>Parameters:<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>disp: ndarray</dt><dd><p>displacement field, in the shape of
system.substrate.nb_subdomain_grid_pts</p>
</dd>
<dt>gap: ndarray</dt><dd><p>gap , in the shape of
system.substrate.nb_subdomain_grid_pts</p>
</dd>
<dt>pot: bool, optional</dt><dd><p>Whether to evaluate the energy, default True</p>
</dd>
<dt>forces: bool, optional</dt><dd><p>Whether to evaluate the forces, default False</p>
</dd>
<dt>logger: ContactMechanics.Tools.Logger</dt><dd><p>information of current state of the system will be
passed to
logger at every evaluation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.primal_hessian_product">
<span class="sig-name descname"><span class="pre">primal_hessian_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">des_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.primal_hessian_product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.primal_hessian_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the hessian product of the primal_objective function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Adhesion.System.Systems.SmoothContactSystem.primal_objective">
<span class="sig-name descname"><span class="pre">primal_objective</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disp0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Adhesion/System/Systems.html#SmoothContactSystem.primal_objective"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Adhesion.System.Systems.SmoothContactSystem.primal_objective" title="Permalink to this definition">¶</a></dt>
<dd><p>To solve the primal objective using gap as the variable.
Can be fed directly to standard solvers ex: scipy solvers etc
and returns the elastic energy and it’s gradient (negative of
the forces) as a function of the gap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gap</strong> (<em>float</em>) – gap between the contact surfaces.</p></li>
<li><p><strong>offset</strong> (<em>float</em>) – constant value to add to the surface heights</p></li>
<li><p><strong>pot</strong> (<em>(</em><em>default False</em><em>)</em>) – </p></li>
<li><p><strong>gradient</strong> (<em>(</em><em>default True</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>energy</strong> (<em>float</em>) – value of energy(scalar value).</p></li>
<li><p><strong>force</strong> (<em>float,array</em>) – value of force(array).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Objective:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_u f = \frac{1}{2} u_i K_{ij} u_j + \phi (u_{ij})\\
\\
\nabla f = K_{ij} u_j + \phi^{\prime} \text{    which is the force} \\\end{split}\]</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-Adhesion.System">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-Adhesion.System" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Adhesion.ReferenceSolutions.html" class="btn btn-neutral float-right" title="Adhesion.ReferenceSolutions package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Adhesion.Interactions.html" class="btn btn-neutral float-left" title="Adhesion.Interactions package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2015-2020 The Authors.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>